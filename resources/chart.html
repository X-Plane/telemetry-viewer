<!DOCTYPE html>
<html>
	<head>
		<title>Test</title>
		<script src="chart.js" type="text/javascript"></script>
		<style>
			html, body {
				overflow: hidden;
				margin: 0 !important;
				padding: 0 !important;
			}
		</style>

	</head>
	<body onresize="update_canvas()">

		<div id="canvas-container">
			<canvas id="chart"></canvas>
		</div>

		<script>

			function format_time(value)
			{
				let hours = Math.floor(value / 60 / 60);
				let minutes = Math.floor((value / 60) % 60);
				let seconds = Math.floor(value % 60);

				let formatted_seconds = `0${seconds}`.slice(-2);

				if(hours > 0)
				{
					let formatted_minutes = `0${seconds}`.slice(-2);
					return `${hours}:${formatted_minutes}:${formatted_seconds}`;
				}

				return `${minutes}:${formatted_seconds}`;
			}

			function format_bytes(value)
			{
				let suffix = [ 'b', 'kB', 'Mb', 'Gb', 'Tb' ];
				let index = 0;

				while(value >= 1024)
				{
					value /= 1024;
					index ++;
				}

				return `${value.toFixed(2)} ${suffix[index]}`
			}

			var canvas = document.getElementById('chart');
			var container = document.getElementById('canvas-container');

			var ctx = canvas.getContext('2d');
			var chart_config = {
				type: 'bar',
				options: {
					animation: {
						duration: 0
					},
					hover: {
						animationDuration: 0
					},
					responsiveAnimationDuration: 0,
					responsive: true,
					maintainAspectRatio: false,
					interaction: {
						mode: 'x'
					},
					scales: {
						xAxis: {
							ticks: {
								stepSize: 10,
								callback: (value, index, values) => {
									return format_time(value);
								}
							},
							type: 'linear',
							position: 'bottom'
						},
						memoryAxis: {
							ticks: {
								min: 0,
								callback: (value, index, values) => {
									return format_bytes(value);
								}
							},
							type: 'linear',
							display: 'auto',
							position: 'right'
						},
						fpsAxis: {
							ticks: {
								min: 0,
								callback: (value, index, values) => {
									return `${value} FPS`;
								}
							},
							display: 'auto',
							position: 'left'
						},
						timeAxis: {
							ticks: {
								min: 0
							},
							type: 'linear',
							display: 'auto',
							position: 'left'
						},
						valueAxis: {
							ticks: {
								min: 0
							},
							type: 'linear',
							display: 'auto',
							position: 'right'
						},
					},
					pan: {
						enabled: true,
						mode: 'xy'
					},
					zoom: {
						enabled: true,
						mode: 'xy',
					},
					plugins: {
						decimation: {
							enabled: true,
							algorithm: 'min-max'
						}
					}
				}
			};

			var chart = new Chart(ctx, chart_config);

			function update_canvas()
			{
				var width = window.innerWidth || document.body.clientWidth;
				var height = window.innerHeight || document.body.clientHeight;

				container.style.width = `${width}px`;
				container.style.height = `${height}px`;

				chart.resize();
			}

			update_canvas();

			function set_data(data)
			{
				chart.data = { datasets: data };
				chart.update();
			}

			function clear_data()
			{
				chart.data = { datasets: [] };
				chart.update();
			}

		</script>
	</body>
</html> 